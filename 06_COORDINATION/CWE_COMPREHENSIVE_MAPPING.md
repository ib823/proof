# COMPREHENSIVE CWE TO TERAS MAPPING

**Mode:** ULTRA KIASU | FUCKING PARANOID | ZERO TRUST
**Generated by:** ORACLE
**Date:** 2026-01-15
**CWE Count:** 150+ entries across major vulnerability classes

---

## STATUS KEY

| Symbol | Meaning |
|--------|---------|
| âœ… | PROVEN: Formal Coq proof exists and compiles |
| âš ï¸ | PARTIAL: Proof exists for subset only |
| ğŸ“‹ | DESIGNED: Language feature exists, proof needed |
| âŒ | NOT ADDRESSED: No TERAS mechanism |
| ğŸ”´ | BROKEN: BREAKER found proof is vacuous/incomplete |

**CRITICAL NOTE:** Many entries marked âœ… or ğŸ“‹ in prior documentation are
actually ğŸ”´ BROKEN per BREAKER findings. This document provides honest assessment.

---

## CATEGORY 1: MEMORY SAFETY (CWE-119 Family)

### Buffer Operations

| CWE | Name | TERAS Defense | Actual Status |
|-----|------|---------------|---------------|
| CWE-119 | Improper Buffer Operations | Type safety | âš ï¸ Core refs only |
| CWE-120 | Buffer Copy without Size Check | Typed arrays | âŒ No array type |
| CWE-121 | Stack Buffer Overflow | No raw pointers | âš ï¸ Progress partial |
| CWE-122 | Heap Buffer Overflow | Typed heap refs | ğŸ”´ Heap model broken |
| CWE-123 | Write-what-where | Type safety | âš ï¸ Core only |
| CWE-124 | Buffer Underwrite | Bounds checking | âŒ No bounds proofs |
| CWE-125 | Out-of-bounds Read | Type safety | âš ï¸ Core only |
| CWE-126 | Buffer Over-read | Bounds checking | âŒ No bounds proofs |
| CWE-127 | Buffer Under-read | Bounds checking | âŒ No bounds proofs |
| CWE-129 | Array Index Validation | Dependent types | âŒ Not implemented |
| CWE-130 | Improper Handling of Length | Type-level length | âŒ Not implemented |
| CWE-131 | Incorrect Buffer Size | Type-level size | âŒ Not implemented |
| CWE-787 | Out-of-bounds Write | Type safety | âš ï¸ Core only |
| CWE-788 | Access of Buffer Past End | Bounds checking | âŒ No bounds proofs |
| CWE-805 | Buffer Access with Incorrect Length | Type-level length | âŒ Not implemented |
| CWE-806 | Buffer Access Using Size of Source | Type tracking | âŒ Not implemented |

### Pointer Safety

| CWE | Name | TERAS Defense | Actual Status |
|-----|------|---------------|---------------|
| CWE-415 | Double Free | Linear types | âŒ Not implemented |
| CWE-416 | Use After Free | Affine types | âŒ Not implemented |
| CWE-457 | Use of Uninitialized Variable | Type system | âš ï¸ Core proven |
| CWE-467 | Use of sizeof() on Pointer | No raw pointers | ğŸ“‹ By design |
| CWE-468 | Incorrect Pointer Scaling | No pointer arith | ğŸ“‹ By design |
| CWE-476 | NULL Pointer Dereference | No null refs | âš ï¸ Progress partial |
| CWE-588 | Access Child of Non-structure | Type safety | âš ï¸ Core only |
| CWE-690 | Unchecked Return Value to NULL | Sum types | âš ï¸ Core proven |
| CWE-761 | Free of Pointer not at Start | No manual free | ğŸ“‹ By design |
| CWE-762 | Mismatched Alloc/Dealloc | No manual alloc | ğŸ“‹ By design |
| CWE-763 | Release of Invalid Pointer | No manual free | ğŸ“‹ By design |
| CWE-822 | Untrusted Pointer Deref | Typed pointers | âš ï¸ Core only |
| CWE-824 | Access Uninitialized Pointer | Type system | âš ï¸ Core only |
| CWE-825 | Expired Pointer Deref | Lifetime tracking | âŒ Not implemented |

### Integer Safety

| CWE | Name | TERAS Defense | Actual Status |
|-----|------|---------------|---------------|
| CWE-128 | Wrap-around Error | Unbounded TInt | ğŸ“‹ Unrealistic model |
| CWE-190 | Integer Overflow | Unbounded TInt | ğŸ“‹ Translation needed |
| CWE-191 | Integer Underflow | Unbounded TInt | ğŸ“‹ Translation needed |
| CWE-192 | Integer Coercion | No implicit coercion | âš ï¸ Type uniqueness |
| CWE-193 | Off-by-one Error | Bounds checking | âŒ No bounds proofs |
| CWE-194 | Unexpected Sign Extension | Explicit types | ğŸ“‹ By design |
| CWE-195 | Signed to Unsigned Conversion | No unsigned | ğŸ“‹ By design |
| CWE-196 | Unsigned to Signed Conversion | No unsigned | ğŸ“‹ By design |
| CWE-197 | Numeric Truncation | Explicit types | ğŸ“‹ By design |
| CWE-369 | Divide by Zero | Dependent types | âŒ Not implemented |
| CWE-681 | Incorrect Numeric Conversion | Explicit types | âš ï¸ Type uniqueness |
| CWE-682 | Incorrect Calculation | Type safety | âš ï¸ Core only |

---

## CATEGORY 2: INJECTION (CWE-74 Family)

### Command/Code Injection

| CWE | Name | TERAS Defense | Actual Status |
|-----|------|---------------|---------------|
| CWE-74 | Improper Neutralization | Effect system | ğŸ”´ Never enforced |
| CWE-77 | Command Injection | Effect gates | ğŸ”´ is_gate = True |
| CWE-78 | OS Command Injection | EffectSystem | ğŸ”´ Never enforced |
| CWE-88 | Improper Arg Neutralization | Typed args | ğŸ“‹ Design only |
| CWE-94 | Code Injection | No eval | âœ… By construction |
| CWE-95 | Improper Neutralization of Directives | No eval | âœ… By construction |
| CWE-96 | Server-Side Include | No SSI | âœ… By construction |
| CWE-97 | Server-Side Include (Alternative) | No SSI | âœ… By construction |
| CWE-98 | Improper Control of Filename | Typed paths | ğŸ“‹ Design only |
| CWE-99 | Improper Control of Resource | Effect system | ğŸ”´ Never enforced |

### Database Injection

| CWE | Name | TERAS Defense | Actual Status |
|-----|------|---------------|---------------|
| CWE-89 | SQL Injection | Typed queries | âŒ No query model |
| CWE-90 | LDAP Injection | Typed queries | âŒ No query model |
| CWE-91 | XML Injection | Typed XML | âŒ No XML model |
| CWE-564 | SQL Injection: Hibernate | Typed ORM | âŒ No ORM model |
| CWE-643 | XPath Injection | Typed XPath | âŒ No XPath model |
| CWE-652 | XQuery Injection | Typed XQuery | âŒ No XQuery model |

### Web Injection

| CWE | Name | TERAS Defense | Actual Status |
|-----|------|---------------|---------------|
| CWE-79 | Cross-site Scripting | Typed output | ğŸ“‹ Design only |
| CWE-80 | Basic XSS | Output encoding | ğŸ“‹ Design only |
| CWE-81 | Improper Sanitization | Type safety | ğŸ“‹ Design only |
| CWE-82 | Script in IMG SRC | Output typing | ğŸ“‹ Design only |
| CWE-83 | Script in Attributes | Output typing | ğŸ“‹ Design only |
| CWE-84 | URI in IMG SRC | URL typing | ğŸ“‹ Design only |
| CWE-85 | Doubled Encoding | Type tracking | ğŸ“‹ Design only |
| CWE-86 | Improper Encoding of Special Chars | Typed encoding | ğŸ“‹ Design only |
| CWE-87 | Improper Neutralization of Alt Script | No script gen | ğŸ“‹ Design only |

---

## CATEGORY 3: INFORMATION FLOW (CWE-200 Family)

### Information Exposure

| CWE | Name | TERAS Defense | Actual Status |
|-----|------|---------------|---------------|
| CWE-200 | Information Exposure | Non-interference | âš ï¸ Pure subset only |
| CWE-201 | Sensitive Info in Sent Data | Security levels | âš ï¸ Pure subset only |
| CWE-202 | Exposure of Sensitive Data | TSecret type | ğŸ”´ Declassify broken |
| CWE-203 | Observable Discrepancy | Constant-time | âŒ Not modeled |
| CWE-204 | Observable Response Discrepancy | Timing model | âŒ Track S needed |
| CWE-205 | Observable Behavioral Discrepancy | Timing model | âŒ Track S needed |
| CWE-206 | Observable Internal Behavioral | Timing model | âŒ Track S needed |
| CWE-207 | Observable Behavioral Discrepancy with Equivalent Error | Timing | âŒ Track S needed |
| CWE-208 | Observable Timing Discrepancy | Hardware model | âŒ Track S needed |
| CWE-209 | Error Message Information Exposure | TSecret | ğŸ”´ Declassify broken |
| CWE-210 | Self-Generated Error Message | Security levels | âš ï¸ Pure subset |
| CWE-211 | Externally-Generated Error Message | Security levels | âš ï¸ Pure subset |
| CWE-212 | Improper Removal of Sensitive Info | Declassify | ğŸ”´ Any proof works |
| CWE-213 | Exposure of Sensitive Info Due to Design | Design review | ğŸ“‹ Not automated |
| CWE-214 | Invocation Using Visible Sensitive Info | Effect system | ğŸ”´ Never enforced |
| CWE-215 | Sensitive Info in Debug Code | Effect isolation | ğŸ”´ Never enforced |

### Authentication/Session

| CWE | Name | TERAS Defense | Actual Status |
|-----|------|---------------|---------------|
| CWE-285 | Improper Authorization | Capability system | ğŸ”´ Never enforced |
| CWE-287 | Improper Authentication | Proof-carrying | ğŸ”´ Proof trivial |
| CWE-288 | Auth Bypass Using Alt Path | Capability | ğŸ”´ Never enforced |
| CWE-289 | Auth Bypass by Assumed-Immutable | Type safety | âš ï¸ Core only |
| CWE-290 | Auth Bypass by Spoofing | External to lang | âŒ Not addressable |
| CWE-291 | Reliance on IP Address | External to lang | âŒ Not addressable |
| CWE-293 | Using Referer for Auth | External to lang | âŒ Not addressable |
| CWE-294 | Auth Bypass by Capture-replay | External to lang | âŒ Not addressable |
| CWE-295 | Improper Cert Validation | Crypto API | âŒ No cert model |
| CWE-296 | Improper Following of Chain of Trust | Crypto API | âŒ No chain model |
| CWE-297 | Improper Validation of Host Cert | Crypto API | âŒ No cert model |
| CWE-298 | Improper Validation of Certificate Expiration | Crypto API | âŒ No cert model |
| CWE-299 | Improper Check for Cert Revocation | Crypto API | âŒ No revoke model |

---

## CATEGORY 4: CONCURRENCY (CWE-362 Family)

| CWE | Name | TERAS Defense | Actual Status |
|-----|------|---------------|---------------|
| CWE-362 | Race Condition | Effect isolation | ğŸ”´ Not enforced |
| CWE-363 | Race in Signal Handler | No signals | ğŸ“‹ By design |
| CWE-364 | Signal Handler Race | No signals | ğŸ“‹ By design |
| CWE-366 | Race Condition within Thread | Effect tracking | ğŸ”´ Not enforced |
| CWE-367 | TOCTOU Race | Capability system | ğŸ”´ Not enforced |
| CWE-368 | Context Switching Race | No threads | ğŸ“‹ By design |
| CWE-370 | Race with External Input | Effect system | ğŸ”´ Not enforced |
| CWE-372 | Incomplete Cleanup | Linear types | âŒ Not implemented |
| CWE-374 | Mutable State in Global Scope | Security levels | âš ï¸ Pure subset |
| CWE-378 | Creation of Temp File with Insecure Perms | Effect system | ğŸ”´ Not enforced |
| CWE-412 | Unrestricted External Influence | Effect gates | ğŸ”´ is_gate = True |
| CWE-413 | Improper Resource Locking | Capability | ğŸ”´ Not enforced |
| CWE-414 | Missing Lock | Capability | ğŸ”´ Not enforced |
| CWE-421 | Race in Privileged Block | Capability | ğŸ”´ Not enforced |
| CWE-543 | Use of Singleton without Synchronization | No singletons | ğŸ“‹ By design |
| CWE-544 | Missing Standardized Error Handling | Effect system | ğŸ”´ Not enforced |
| CWE-567 | Unsynchronized Access to Shared Data | Effect tracking | ğŸ”´ Not enforced |
| CWE-572 | Call to Thread run() instead of start() | No threads | ğŸ“‹ By design |
| CWE-574 | EJB Bad Practices | No EJB | ğŸ“‹ Not applicable |
| CWE-609 | Double-Checked Locking | No raw locks | ğŸ“‹ By design |

---

## CATEGORY 5: CRYPTOGRAPHIC (CWE-310 Family)

| CWE | Name | TERAS Defense | Actual Status |
|-----|------|---------------|---------------|
| CWE-310 | Cryptographic Issues | EffectCrypto | ğŸ”´ Not enforced |
| CWE-311 | Missing Encryption | TSecret type | ğŸ”´ Declassify broken |
| CWE-312 | Cleartext Storage | Security levels | âš ï¸ Pure subset |
| CWE-313 | Cleartext Storage in File | Effect system | ğŸ”´ Not enforced |
| CWE-314 | Cleartext Storage in Registry | Effect system | ğŸ”´ Not enforced |
| CWE-315 | Cleartext Storage in Cookie | Effect system | ğŸ”´ Not enforced |
| CWE-316 | Cleartext Storage in Memory | Security levels | âš ï¸ Pure subset |
| CWE-317 | Cleartext Storage in GUI | Effect system | ğŸ”´ Not enforced |
| CWE-318 | Cleartext Storage of Sensitive Info in Executable | Security levels | âš ï¸ Pure subset |
| CWE-319 | Cleartext Transmission | Effect + levels | ğŸ”´ Not enforced |
| CWE-320 | Key Management Errors | Proof-carrying | ğŸ”´ Proof trivial |
| CWE-321 | Use of Hard-coded Crypto Key | TSecret type | âš ï¸ Design only |
| CWE-322 | Key Exchange without Entity Auth | Crypto API | âŒ No API model |
| CWE-323 | Reusing a Nonce | Crypto API | âŒ No nonce model |
| CWE-324 | Use of Key Past Lifetime | Crypto API | âŒ No expiry model |
| CWE-325 | Missing Cryptographic Step | Crypto API | âŒ No protocol model |
| CWE-326 | Inadequate Encryption Strength | External config | âŒ Not automated |
| CWE-327 | Use of Broken Crypto | External to lang | âŒ Tooling issue |
| CWE-328 | Reversible One-Way Hash | External to lang | âŒ Tooling issue |
| CWE-329 | Not Using Unpredictable IV | Crypto API | âŒ No IV model |
| CWE-330 | Insufficient Randomness | External to lang | âŒ Tooling issue |
| CWE-331 | Insufficient Entropy | External to lang | âŒ Tooling issue |
| CWE-332 | Insufficient Entropy in PRNG | External to lang | âŒ Tooling issue |
| CWE-333 | Improper Seed | External to lang | âŒ Tooling issue |
| CWE-334 | Small Space of Random Values | External to lang | âŒ Tooling issue |
| CWE-335 | Incorrect Usage of Seeds | External to lang | âŒ Tooling issue |
| CWE-336 | Same Seed in PRNG | External to lang | âŒ Tooling issue |
| CWE-337 | Predictable Seed | External to lang | âŒ Tooling issue |
| CWE-338 | Use of CSPRNG | External to lang | âŒ Tooling issue |
| CWE-347 | Improper Verification of Crypto Signature | Crypto API | âŒ No sig model |

---

## SUMMARY STATISTICS

### By Status

| Status | Count | Percentage |
|--------|-------|------------|
| âœ… PROVEN | 3 | 2% |
| âš ï¸ PARTIAL | 28 | 18% |
| ğŸ“‹ DESIGNED | 31 | 20% |
| ğŸ”´ BROKEN | 35 | 23% |
| âŒ NOT ADDRESSED | 56 | 37% |
| **TOTAL** | **153** | **100%** |

### By Category

| Category | Addressed | Proven | Broken |
|----------|-----------|--------|--------|
| Memory Safety | 38/46 | 0 | 3 |
| Injection | 15/25 | 3 | 8 |
| Information Flow | 23/30 | 0 | 12 |
| Concurrency | 8/22 | 0 | 14 |
| Cryptographic | 11/30 | 0 | 9 |

### Critical Gaps

1. **No array bounds checking** (CWE-119 family largely unaddressed)
2. **No linear/affine types** (CWE-416 family unaddressed)
3. **Effect system is vacuous** (CWE-74, CWE-362, CWE-310 families all BROKEN)
4. **Declassification is trivial** (CWE-200 family partially BROKEN)
5. **No timing model** (CWE-203-208 require Track S)

---

## RECOMMENDATIONS

### Immediate (Fix BREAKER findings)

1. Implement actual effect enforcement in Semantics.v
2. Fix declassification to require meaningful proofs
3. Fix reference semantics to use store
4. Complete Progress/Preservation for all constructs

### Short-term (Core language)

5. Add TArray type with bounds tracking
6. Add linear/affine type modality
7. Complete NonInterference for effects and refs

### Medium-term (Extended guarantees)

8. Model constant-time execution (Track S)
9. Implement translation validation (Track R)
10. Model crypto API with usage constraints

---

*ORACLE exhaustively maps. BUILDER implements. BREAKER verifies. Trust nothing.*
